"use strict";var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var e in s)s.hasOwnProperty(e)&&(t[e]=s[e])};return function(s,e){function i(){this.constructor=s}t(s,e),s.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),GridLayout=function(t){function s(){var s=t.call(this)||this;return s.gridAttributes={gridColumnStart:"data-grid-column-start",gridColumnEnd:"data-grid-column-end",gridRowStart:"data-grid-row-start",gridRowEnd:"data-grid-row-end"},s.msGridAttributes={msGridColumn:"data-grid-column-start",msGridColumnSpan:"data-grid-column-end",msGridRow:"data-grid-row-start",msGridRowSpan:"data-grid-row-end"},s.state={},s.support=s._detectGridSupport(),s}return __extends(s,t),s.prototype.connectedCallback=function(){this._getState(),this._setStyles(),this._setObserver()},s.prototype.disconnectedCallback=function(){this.childObserver&&this.childObserver.disconnect()},s.prototype._detectGridSupport=function(){var t=document.createElement("div");return"string"==typeof t.style.grid?"grid":(t.style.msGridColumn,"msGrid")},s.prototype._attributeValidation=function(t,s){switch(t){case"columns":case"rows":if("grid"===this.support)return/^\d+$/g.test(s)?"repeat("+s+", 1fr)":s;for(var e=parseInt(s,10),i=[],r=1;r<=e;r++)i.push("1fr");return i.join(" ");case"auto-flow":return/^((row|column) ?)?(dense)?$/.test(s)?s:"row";default:return s}},s.prototype._getState=function(t,e){var i=this;return t?void(this.state[t]=this._attributeValidation(t,e)):void s.observedAttributes.map(function(t){i.state[t]=i._attributeValidation(t,i.getAttribute(t))})},s.prototype._setStyles=function(){if(null==this.support)throw new Error("No CSS support");return"msGrid"===this.support?void this._setLegacyStyles():(this.style.display=this.hasAttribute("inline")?"inline-grid":"grid",this.state.columns&&(this.style.gridTemplateColumns=this.state.columns),this.state.rows&&(this.style.gridTemplateRows=this.state.rows),this.state["auto-columns"]&&(this.style.gridAutoColumns=this.state["auto-columns"]),this.state["auto-rows"]&&(this.style.gridAutoRows=this.state["auto-rows"]),this.state.gap?this.style.gridGap=this.state.gap:(this.state["row-gap"]&&(this.style.gridRowGap=this.state["row-gap"]),this.state["column-gap"]&&(this.style.gridColumnGap=this.state["column-gap"])),void(this.state["auto-flow"]&&(this.style.gridAutoFlow=this.state["auto-flow"])))},s.prototype._setLegacyStyles=function(){this.style.display=this.hasAttribute("inline")?"-ms-inline-grid":"-ms-grid",this.state.columns&&(this.style.msGridColumns=this.state.columns),this.state.rows&&(this.style.msGridRows=this.state.rows),this.state["align-self"]&&(this.style.msGridRowAlign=this.state["align-self"]),this.state["justify-self"]&&(this.style.msGridColumnAlign=this.state["justify-self"])},s.prototype._setObserver=function(){var t=this;this.childObserver=new MutationObserver(function(s){var e=[];s.forEach(function(s){"attributes"===s.type&&s.target.parentNode===t&&e.push(s.target)}),e.forEach(function(s){t._setChildAttributes(s)})});var s={attributes:!0,childList:!0,attributeFilter:Object.keys(this.gridAttributes).map(function(s){return t.gridAttributes[s]}),subtree:!0,attributeOldValue:!1},e=Object.keys(this.gridAttributes);Array.from(this.children).filter(function(t){var s=Object.keys(t.dataset);return e.filter(function(t){return s.indexOf(t)>-1}).length>0}).forEach(function(s){t._setChildAttributes(s)}),this.childObserver.observe(this,s)},s.prototype._setChildAttributes=function(t){if(t){if("msGrid"===this.support)return void this._setMsGridChildAttributes(t);var s=t.dataset;Object.keys(this.gridAttributes).forEach(function(e){t.style[e]=s[e]||""})}},s.prototype._setMsGridChildAttributes=function(t){var s=this;if(t){var e=t;Object.keys(this.msGridAttributes).forEach(function(t){var i=e.getAttribute(s.msGridAttributes[t]);if(null!=i)if("Span"===t.substr(-4)){var r=t.substr(0,t.length-4),o=s.msGridAttributes[r],n=parseInt(e.getAttribute(o)||"1",10),a=parseInt(i,10)||n;e.style[t]=(a-n).toString()||"1"}else e.style[t]=i||""})}},Object.defineProperty(s,"observedAttributes",{get:function(){return["gap","column-gap","row-gap","inline","columns","rows","auto-rows","auto-columns","auto-flow","align-self","justify-self"]},enumerable:!0,configurable:!0}),s.prototype.attributeChangedCallback=function(t,s,e){this._getState(t,e),this._setStyles()},s}(HTMLElement);window.customElements.define("grid-layout",GridLayout);